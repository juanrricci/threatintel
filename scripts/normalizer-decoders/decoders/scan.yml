---
mapname:    scan events
author:     wazuh threatintell team
created:    2021-02-05
updated:    2021-02-05


vendor:     wazuh-scanner
module:     sca, vulnerability
format:     json
reference:  www.example.com

prematch:
  condition: or
  has_field: 
    - vulnerability
    - sca
    
options: 
    - geo:  yes
    - force: yes

events:
    - event: 
        id:             "001"
        description:    "Evento de reconocimiento"
        processors: 
            - set:          
              original:     sca.scan_id
              destination:  scan.id
            - set:          
              original:     sca.type
              destination:  scan.type
            - set:          
              original:     sca.policy
              destination:  scan.policy
            - set:          
              original:     sca.score
              destination:  scan.score
            - set:          
              original:     sca.total_checks
              destination:  scan.total_checks
            - set:          
              original:     sca.policy_id
              destination:  scan.policy_id
            - set:          
              original:     sca.invalid
              destination:  scan.invalid
            - set:          
              original:     sca.description
              destination:  scan.description
            - set:          
              original:     sca.passed
              destination:  scan.passed
            - set:          
              original:     sca.failed
              destination:  scan.failed
            - set:          
              original:     first_scan
              destination:  scan.first_scan
            - set:          
              original:     force_alert
              destination:  scan.force_alert
            - set:          
              original:     sca.check.remediation
              destination:  scan.check.remediation
            - set:          
              original:     sca.check.previous_result
              destination:  scan.check.previous_result
            - set:          
              original:     check.registry
              destination:  scan.check.registry
            - set:          
              original:     sca.check.reason
              destination:  scan.check.reason
            - set:          
              original:     sca.check.compliance.pci_dss
              destination:  scan.check.compliance.pci_dss
            - set:          
              original:     sca.check.compliance.hipaa
              destination:  scan.check.compliance.hipaa
            - set:          
              original:     sca.check.compliance.tsc
              destination:  scan.check.compliance.tsc
            - set:          
              original:     sca.check.compliance.cis_csc
              destination:  scan.check.compliance.cis_csc
            - set:          
              original:     sca.check.compliance.gdpr_IV
              destination:  scan.check.compliance.gdpr_IV
            - set:          
              original:     sca.check.compliance.cis
              destination:  scan.check.compliance.cis
            - set:          
              original:     sca.check.compliance.nist_800_53
              destination:  scan.check.compliance.nist_800_53
            - set:          
              original:     sca.check.compliance.gpg_13
              destination:  scan.check.compliance.gpg_13
            - set:          
              original:     sca.check.description
              destination:  scan.check.description
            - set:          
              original:     sca.check.id
              destination:  scan.check.id
            - set:          
              original:     sca.check.title
              destination:  scan.check.title
            - set:          
              original:     sca.check.rationale
              destination:  scan.check.rationale
            - set:          
              original:     sca.check.command
              destination:  scan.check.command
            - set:          
              original:     sca.check.status
              destination:  scan.check.status
            - set:          
              original:     vulnerability.package.condition
              destination:  scan.package.condition
            - set:          
              original:     vulnerability.package.generated_cpe
              destination:  scan.package.generated_cpe
            - set:          
              original:     vulnerability.assigner
              destination:  scan.vulnerability.assigner
            - set:          
              original:     vulnerability.published
              destination:  scan.vulnerability.published
            - set:          
              original:     vulnerability.cwe_reference
              destination:  scan.vulnerability.cwe_reference
            - set:          
              original:     vulnerability.advisories_ids
              destination:  scan.vulnerability.advisories_ids
            - set:          
              original:     vulnerability.bugzilla_references
              destination:  scan.vulnerability.bugzilla_references
            - set:          
              original:     vulnerability.cvss.cvss2.base_score
              destination:  scan.vulnerability.cvss2.score.base
            - set:          
              original:     vulnerability.cvss.cvss2.vector.integrity_impact
              destination:  scan.vulnerability.cvss2.vector.integrity_impact
            - set:          
              original:     vulnerability.cvss.cvss2.vector.confidentiality_impact
              destination:  scan.vulnerability.cvss2.vector.confidentiality_impact
            - set:          
              original:     vulnerability.cvss.cvss2.vector.availability
              destination:  scan.vulnerability.cvss2.vector.availability
            - set:          
              original:     vulnerability.cvss.cvss2.vector.attack_vector
              destination:  scan.vulnerability.cvss2.vector.attack_vector
            - set:          
              original:     vulnerability.cvss.cvss2.vector.access_complexity
              destination:  scan.vulnerability.cvss2.vector.access_complexity
            - set:          
              original:     vulnerability.cvss.cvss2.vector.authentication
              destination:  scan.vulnerability.cvss2.vector.authentication
            - set:          
              original:     vulnerability.cvss.cvss3.base_score
              destination:  scan.vulnerability.cvss3.base_score
            - set:          
              original:     vulnerability.cvss.cvss3.vector.user_interaction
              destination:  scan.vulnerability.cvss3.vector.user_interaction
            - set:          
              original:     vulnerability.cvss.cvss3.vector.integrity_impact
              destination:  scan.vulnerability.cvss3.vector.integrity_impact
            - set:          
              original:     vulnerability.cvss.cvss3.vector.scope
              destination:  scan.vulnerability.cvss3.vector.scope
            - set:          
              original:     vulnerability.cvss.cvss3.vector.confidentiality_impact
              destination:  scan.vulnerability.cvss3.vector.confidentiality_impact
            - set:          
              original:     vulnerability.cvss.cvss3.vector.availability
              destination:  scan.vulnerability.cvss3.vector.availability
            - set:          
              original:     vulnerability.cvss.cvss3.vector.attack_vector
              destination:  scan.vulnerability.cvss3.vector.attack_vector
            - set:          
              original:     vulnerability.cvss.cvss3.vector.access_complexity
              destination:  scan.vulnerability.cvss3.vector.access_complexity
            - set:          
              original:     vulnerability.cvss.cvss3.vector.privileges_required
              destination:  scan.vulnerability.cvss3.vector.privileges_required
            - set:          
              original:     vulnerability.rationale
              destination:  scan.vulnerability.rationale
            - set:          
              original:     vulnerability.updated
              destination:  scan.vulnerability.updated
            - set:          
              original:     vulnerability.cve_version
              destination:  scan.vulnerability.cve_version
            - set:          
              original:     sca.file
              destination:  scan.file.name
            - set:          
              original:     start_time
              destination:  scan.event.start
            - set:          
              original:     end_time
              destination:  scan.event.end
            - set:          
              original:     hash
              destination:  scan.hash.md5
            - set:          
              original:     hash_file
              destination:  scan.file.hash.md5
            - set:          
              original:     vulnerability.severity
              destination:  scan.vulnerability.severity
            - set:          
              original:     vulnerability.package.name
              destination:  scan.package.name
            - set:          
              original:     vulnerability.package.version
              destination:  scan.package.version
            - set:          
              original:     vulnerability.package.architecture
              destination:  scan.package.architecture
            - set:          
              original:     vulnerability.cve
              destination:  scan.vulnerability.id
            - set:          
              original:     vulnerability.references
              destination:  scan.vulnerability.reference
            - set:          
              original:     vulnerability.title
              destination:  scan.vulnerability.description