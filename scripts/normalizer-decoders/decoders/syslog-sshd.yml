---

mapname:    syslog ssh events
author:     wazuh threatintell team
created:    2021-02-05
updated:    2021-02-05


vendor:     syslog
component:  sshd
format:     plaintext
reference:  www.example.com

prematch:
  action: OR
  regex: 
    - '^sshd\[\d+\]:'
    - '^\w+\s+\d+\s+\d+:\d+:\d+\s+\S+\s+sshd\[\d+\]:'

options:
  - geo:  yes

events:
    - event: 
        id:             "001"
        
        description:    "Invalid user"
        processors: 
              - decode:
                regex: '^(?P<timestamp>\w+\s+\d+\s+\d+:\d+:\d+)\s+(?P<hostname>\S+)\s+(?P<program_name>sshd)\[(?P<pid>\d+)\]: Invalid user (?P<dstuser>\S+)\s+from\s+(?P<srcip>\S+)\s+port\s+(?P<port>\S+)'

              - set: 
                original: timestamp
                destination: timestamp
              - set: 
                original: program_name
                destination: process.name
              - set: 
                original: hostname
                destination: host.hostname
              - set: 
                original: dstuser
                destination: user.name
              - set: 
                original: srcip
                destination: source.ip                
              - set: 
                original: destination_hostname
                destination: destination.hostname
              - set: 
                original: pid
                destination: process.pid
              - set: 
                original: port
                destination: source.port
              - geo:
                original: srcip
              - geo: 
                original: destination_hostname