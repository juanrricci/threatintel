---

mapname:    syslog ssh events
author:     wazuh threatintell team
created:    2021-02-05
updated:    2021-02-05


vendor:     syslog
component:  sshd
format:     plaintext
reference:  www.example.com

prematch:
  regex: 
    - '^\w+\s+\d+\s+\d+:\d+:\d+\s+\S+\s+sshd\[\d+\]:'

options:
  - geo:  yes

events:
    - event: 
        id:             "001"
        description:    "Invalid user"
        processors: 
              - regex:    '^(?P<timestamp>\w+\s+\d+\s+\d+:\d+:\d+)\s+(?P<destination_hostname>\S+)\s+(?P<process_name>sshd)\[(?P<process_pid>\d+)\]: Invalid user (?P<user_name>\S+)\s+from\s+(?P<source_ip>\S+)\s+port\s+(?P<source_port>\S+)'
              - resolve: 
                original: destination_hostname
                destination: destination.hostname
              - resolve: 
                original: source_ip
                destination: source.hostname
              - resolve: 
                original: process_name
                destination: process.name
              - resolve: 
                original: process_pid
                destination: process.pid
              - resolve: 
                original: source_ip
                destination: source.hostname
              - resolve: 
                original: user_name
                destination: user.name
              - resolve: 
                original: source_port
                destination: source.port                                                                
              - geo:
                original: source_ip
              - geo: 
                original: destination_hostname